# 📝 JWT 인증 심층 분석: 대학생을 위한 '디지털 학생증' 비유

이 문서는 우리 프로젝트의 로그인 시스템이 어떻게 작동하는지, 'JWT(JSON Web Token)'라는 기술을 중심으로 설명합니다. 전공 지식이 없어도 이해할 수 있도록 '디지털 학생증'에 비유하여 풀어보겠습니다.

---

### 1. 디지털 학생증 발급받기 (로그인 과정)

대학교에 합격하면 가장 먼저 무엇을 받나요? 바로 **학생증**입니다. 이 학생증이 있어야만 도서관에 들어가고, 기숙사 문을 열 수 있죠.

우리 프로젝트의 로그인 과정은 이 학생증 발급 과정과 똑같습니다.

-   **학생처**: 우리 프로젝트의 **서버(백엔드)**
-   **학번/비밀번호 제출**: **아이디/비밀번호**로 로그인 시도
-   **학생증 발급**: 로그인 성공 시, 서버가 발급하는 **JWT 토큰**

여러분이 아이디와 비밀번호를 정확히 입력하면, 우리 서버(학생처)는 "아, 우리 학교 학생이 맞구나!"라고 확인하고, 여러분만을 위한 **디지털 학생증(JWT)**을 즉시 발급해 줍니다. 이 디지털 학생증은 단순한 텍스트처럼 보이지만, 실제로는 세 부분으로 나뉜 정교한 구조를 가지고 있습니다.

`eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0dXNlciIsInJvbGUiOiJVU0VSIiwiZXhwIjoxNzE1MjM5MjAwfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`
(이것이 바로 JWT의 실제 모습입니다. `.`을 기준으로 세 부분으로 나뉘어 있죠.)

---

### 2. 디지털 학생증 구조 파헤치기

이 길고 복잡해 보이는 학생증(JWT)은 사실 세 가지 정보의 조합입니다.

#### **가. 헤더 (Header): "이 학생증의 종류와 위조방지 기술은?"**

첫 번째 부분은 학생증의 **규격 정보**입니다.

-   `typ`: "이것은 JWT라는 종류의 디지털 증명서입니다."
-   `alg`: "위조방지 기술로는 **HS512** 방식을 사용했습니다."

이 정보를 그냥 보내면 중간에 누군가 훔쳐보거나 망가뜨릴 수 있으니, **Base64URL 인코딩**이라는 방식으로 포장합니다.

> ** 잠깐! Base64URL 인코딩이란?**
> 컴퓨터가 이해하는 복잡한 데이터(`{ "alg": "HS512" }`)를, 이메일이나 웹 주소(URL)에서 안전하게 사용할 수 있는 단순한 알파벳과 숫자 조합으로 바꾸는 **'안전 포장 기술'**입니다. 암호화처럼 내용을 숨기는 것이 아니라, 데이터가 깨지지 않고 잘 전달되도록 포장하는 것에 가깝습니다.

#### **나. 페이로드 (Payload): "학생증에 담긴 실제 정보"**

두 번째 부분은 학생증의 **핵심 내용**입니다. 여러분의 실제 정보가 담겨있죠.

-   `sub`: "이 학생증의 주인(Subject)은 **'testuser'** 입니다." (여러분의 학번)
-   `role`: "이 학생의 신분(Role)은 **'USER'** 입니다." (학생/교직원 구분)
-   `exp`: "이 학생증은 **2025년 7월 15일 18시**에 만료(Expiration)됩니다." (유효기간)

이 정보 역시 **Base64URL 인코딩**으로 안전하게 포장됩니다. 중요한 점은, 이 정보는 숨겨진 것이 아니라 포장만 된 것이므로, 누구나 마음만 먹으면 포장을 뜯어 내용을 볼 수 있습니다. 따라서 **비밀번호 같은 민감한 정보는 절대 여기에 담으면 안 됩니다.**

#### **다. 서명 (Signature): "절대 위조할 수 없는 홀로그램 스티커"**

세 번째 부분이 바로 이 디지털 학생증의 **핵심 보안 기술**입니다. 학생증의 홀로그램 스티커처럼, 이게 진짜인지 가짜인지 구별하게 해주는 **'전자 서명'**이죠.

이 서명은 다음 세 가지 재료를 섞어 만듭니다.

1.  **포장된 헤더** (첫 번째 부분)
2.  **포장된 페이로드** (두 번째 부분)
3.  **서버만 아는 비밀 키** (학생처의 직인처럼, 외부에는 절대 공개되지 않는 암호)

그리고 이 재료들을 **HS512 해시 함수**라는 마법 믹서기에 넣고 돌립니다.

> ** 잠깐! 해시 함수(HS512)란?**
>
> **해시 함수**는 어떤 데이터든 입력하면, 완전히 새로운 고유한 결과물(지문처럼)을 만들어내는 '마법 믹서기'입니다.
>
> -   **일방향성**: 믹서기에 갈아 만든 주스를 보고 원래 어떤 과일이 들어갔는지 정확히 알 수 없듯, 결과물을 보고 원래 데이터를 추측할 수 없습니다.
> -   **고유성**: 재료가 아주 조금만 달라져도(예: 사과 한 조각 추가), 완전히 다른 맛과 색의 주스가 나옵니다. 즉, 원본 데이터가 1글자만 바뀌어도 결과물은 완전히 달라집니다.
>
> **HS512**는 이 마법 믹서기의 한 종류로, SHA-512라는 강력한 알고리즘을 사용하며, 여기에 서버의 **비밀 키(Secret Key)**까지 추가로 넣어 섞기 때문에 훨씬 더 안전합니다.

결론적으로, **서명**은 `(헤더 + 페이로드)`를 서버의 `비밀 키`로 잠가서, 오직 해당 서버만이 진짜임을 증명할 수 있도록 만든 **'봉인 도장'**인 셈입니다.

---

### 3. 디지털 학생증 사용하기 (API 요청 과정)

이제 발급받은 디지털 학생증(JWT)으로 도서관(게시판 기능)을 이용해 봅시다.

1.  **학생증 제시**: 여러분이 '글쓰기' 버튼을 누르면, 프론트엔드는 HTTP 요청 헤더의 `Authorization`이라는 공간에 여러분의 디지털 학생증(JWT)을 붙여서 서버로 보냅니다.
2.  **서버의 검증**: 서버(학생처 문지기)는 여러분이 제시한 학생증을 보고 다음을 순식간에 확인합니다.
    -   **① 서명 확인**: 받은 학생증의 헤더와 페이로드, 그리고 서버 자신이 가진 비밀 키를 이용해 서명을 **똑같이 다시 만들어 봅니다.** 그리고 학생증에 찍힌 서명과 방금 만든 서명이 일치하는지 비교합니다. 만약 다르다면? 누군가 중간에 내용을 위조한 가짜 학생증이라는 뜻이므로 즉시 출입을 거부합니다.
    -   **② 유효기간 확인**: 서명이 진짜라도, 유효기간(`exp`)이 지났으면 "만료된 학생증입니다!"라며 출입을 거부합니다.

이 모든 검증을 통과해야만, 서버는 비로소 "아, 진짜 우리 학생이 맞고, 유효한 학생증을 가졌구나. 들어오세요."라며 글쓰기 기능을 허용해 줍니다.

---

### ✅ 핵심 요약

-   **JWT는?**: 서버가 발급하는, 위조가 불가능한 **'디지털 학생증'**이다.
-   **로그인은?**: 아이디/비밀번호를 내고 이 학생증을 **발급**받는 과정이다.
-   **API 요청은?**: 기능을 이용할 때마다 학생증을 **제시**하고, 서버가 그 진위 여부를 **검증**하는 과정이다.
-   **Base64URL 인코딩은?**: 학생증 정보가 망가지지 않도록 안전하게 **포장**하는 기술이다.
-   **해시 함수(HS512)와 서명은?**: 서버만 아는 비밀 키로 찍어내는 **위조방지 홀로그램**으로, 학생증의 신뢰성을 보장하는 핵심 기술이다.
